<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Fastlane for beginners | kyryl horbushko</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Fastlane for beginners" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Before we start… originally this post was written on Jan 23, 2017 and available here Sooner or later every developer will have to open Safari and type https://itunesconnect.apple.com to setup application for distribution via AppStore. But exactly after you login in to iTunes, you will understand, that developer account should be setup first." />
<meta property="og:description" content="Before we start… originally this post was written on Jan 23, 2017 and available here Sooner or later every developer will have to open Safari and type https://itunesconnect.apple.com to setup application for distribution via AppStore. But exactly after you login in to iTunes, you will understand, that developer account should be setup first." />
<link rel="canonical" href="http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html" />
<meta property="og:url" content="http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html" />
<meta property="og:site_name" content="kyryl horbushko" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-23T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fastlane for beginners" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html"},"@type":"BlogPosting","url":"http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/favicon.png"}},"headline":"Fastlane for beginners","dateModified":"2017-01-23T00:00:00+02:00","datePublished":"2017-01-23T00:00:00+02:00","description":"Before we start… originally this post was written on Jan 23, 2017 and available here Sooner or later every developer will have to open Safari and type https://itunesconnect.apple.com to setup application for distribution via AppStore. But exactly after you login in to iTunes, you will understand, that developer account should be setup first.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="shortcut icon" type="image/png" href="/assets/favicon.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="kyryl horbushko" />
<meta name='monetization' content='$ilp.uphold.com/GiEjnNF98h8k'>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">kyryl horbushko</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/bookNotes/">Books</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/blog/archives/">Archives</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fastlane for beginners</h1>
    <p class="post-meta"><time class="dt-published" datetime="2017-01-23T00:00:00+02:00" itemprop="datePublished">
        Jan 23, 2017
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">kyryl horbushko</span></span>, 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Lviv</span></span></p>

      
         
          <a class="post-tag" href="/tags/#fastlane">fastlane</a>
         
          <a class="post-tag" href="/tags/#utils">utils</a>
         
          <a class="post-tag" href="/tags/#tutorial">tutorial</a>
         
      
         <span style="float:right;">
          <span class="ert">
    <abbr title="Estimated reading time">Estimated reading time: </abbr>
    
    
    
    

    
    
    

    
    14 minutes
</span>
         </span>
         <br>
      </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <br>
    <ul>
  <li><a href="#environment-setup">Environment setup</a></li>
  <li><a href="#project-setup">Project setup</a></li>
  <li><a href="#match-setup">Match setup</a></li>
  <li><a href="#configuration">Configuration</a></li>
  <li><a href="#bonus">Bonus</a></li>
  <li><a href="#ci-integration">CI integration</a></li>
</ul>
    <br>
    <p>Before we start…</p>

<blockquote>
  <p>originally this post was written on Jan 23, 2017 and available <a href="https://medium.com/@kirill.ge/sudo-save-time-e05dd04c6888">here</a></p>
</blockquote>

<p>Sooner or later every developer will have to open Safari and type <a href="">https://itunesconnect.apple.com</a> to setup application for distribution via AppStore. But exactly after you login in to iTunes, you will understand, that developer account should be setup first.</p>

<!--more-->
<blockquote>
  <p>“Time is what we want most, but what we use worst”
 ― William Penn</p>
</blockquote>

<p>And since you start, you will see that few more additional steps should be done:</p>

<ul>
  <li>create an applicationID</li>
  <li>generate certificates (for developing and for distribution)</li>
  <li>setup application features (for example push - notification)</li>
  <li>generate a set of provision profiles and more</li>
</ul>

<p>And even if you complete this, you should manage all created things, share with teammate, think about security and even more. A lot of stuff, yeh, I know…</p>

<p>“Wait, I just want to send my app to AppStore. Why is not possible to do with one single - line command?».</p>

<p>Actually, it is, and it’s called - <code class="language-plaintext highlighter-rouge">fastlane</code>.</p>

<p>##Overview and requirements</p>

<p>«fastlane - is a tool for iOS, Mac, and Android developers to automate tedious tasks like generating screenshots, dealing with provisioning profiles, and releasing your application.» - this is the very first line that you will see on <a href="https://github.com/fastlane/fastlane">git page</a>, and this is 100% true.</p>

<p><code class="language-plaintext highlighter-rouge">Fastlane</code> is written in <code class="language-plaintext highlighter-rouge">Ruby</code> as a set of more or less independent modules, which have built its rich functionality set. It’s structure is easily extendable, since if you want to add some new functionality to the system, you can write simple Ruby scripts and use them within existing fastlane modules or even add new modules to fastlane.</p>

<p><code class="language-plaintext highlighter-rouge">Fastlane</code> provides a bunch of commands which help automate the deployment of apps or even perform different common task. <code class="language-plaintext highlighter-rouge">Fastlane</code> is very flexible and scalable tool.</p>

<p>Currently fastlane consists of more than 200 different modules.</p>

<p>We’ll list most useful and popular below and show the basic setup for iTunesConnect delivery system using fastlane.</p>

<p>Since I’m software developer for iOS platform we will deep in process of usage fastlane mostly applicable for iOS-developers, but I’m sure that mains steps are same for all platforms that supported by this great tool.</p>

<p><code class="language-plaintext highlighter-rouge">Fastlane</code> for iOS requires following tools to be installed:</p>

<ul>
  <li>macOS X El Capitan or higher</li>
  <li>Xcode - developer - tools for xCode 7 or later</li>
  <li>ruby/brew (optionally, recommended)</li>
  <li>textEditor :)</li>
</ul>

<p>What <code class="language-plaintext highlighter-rouge">fastlane</code> can do for us? Well, the list is quite big and include a lot of things:</p>

<ul>
  <li><strong>deliver</strong>: Upload screenshots, metadata, and your app to the App Store</li>
  <li><strong>supply</strong>: Upload your Android app and its metadata to Google Play</li>
  <li><strong>snapshot</strong>: Automate taking localized screenshots of your iOS and tvOS apps on every device</li>
  <li><strong>screengrab</strong>: Automate taking localized screenshots of your Android app on every device</li>
  <li><strong>frameit</strong>: Quickly put your screenshots into the right device frames</li>
  <li><strong>pem</strong>: Automatically generate and renew your push notification profiles</li>
  <li><strong>sigh</strong>: Because you would rather spend your time building stuff than fighting provisioning</li>
  <li><strong>produce</strong>: Create new iOS apps on iTunes Connect and Dev Portal using the command line</li>
  <li><strong>cert</strong>: Automatically create and maintain iOS code signing certificates</li>
  <li><strong>spaceship</strong>: Ruby library to access the Apple Dev Center and iTunes Connect</li>
  <li><strong>pilot</strong>: The best way to manage your TestFlight testers and builds from your terminal</li>
  <li><strong>boarding</strong>: The easiest way to invite your TestFlight beta testers</li>
  <li><strong>gym</strong>: Building your iOS apps has never been easier</li>
  <li><strong>match</strong>: Easily sync your certificates and profiles across your team using Git</li>
  <li><strong>scan</strong>: The easiest way to run tests for your iOS and Mac apps</li>
</ul>

<p>In this tutorial we will look through few main features such as match, gym, testflight, sigh. This should be enough for start and setup a good delivery system that will save time for you.
So, let’s start.</p>

<h2 id="environment-setup">Environment setup</h2>

<p>To install fastlane open your terminal and do next steps:</p>
<ol>
  <li>check for latest xCode - tools by typing code-select - install</li>
</ol>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_1.png" alt="preview_1" width="550" />
</div>

<blockquote>
  <p>Here, in my case, it’s already installed, if it’s not, you will see log with detailed process description and some pop-Up window with progress for installing xCode tools.</p>
</blockquote>

<ol>
  <li>The next step is to install fastlane itself, to do this just type sudo gem install fastlane</li>
</ol>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_2.png" alt="preview_1" width="550" />
</div>

<p>When this 2 steps are done, we can start setup fastlane for test project.</p>

<h2 id="project-setup">Project setup</h2>

<p>You might already have some project, otherwise you can create new one, single-window application. In this tutorial I’ll create new one. I’ll call it «testFastlane»</p>

<blockquote>
  <p>Tip: If you don’t have project setup in iTunesConnect, you will find “produce” command really useful. I won’t dive into it, but you can get <a href="https://github.com/fastlane/fastlane/tree/master/produce">more info here</a></p>
</blockquote>

<p>Navigate to root folder of your project, open terminal and switch to project dir by typing</p>

<p><code class="language-plaintext highlighter-rouge">cd &lt;path_to_root_proj_folder&gt;</code></p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_3.png" alt="preview_1" width="550" />
</div>

<p>Next, type <code class="language-plaintext highlighter-rouge">fastlane init</code> - this command will create default directory with FASTFILE for you. After you will see request to enter your Apple ID, like developer@apple.com. In the next step - <strong>fastlane</strong> will automatically generate a fastlane configuration for you, based on the information provided.</p>

<blockquote>
  <p>Tip: It’s better to create separate Apple ID for fastlane usage and share it with your team to use with fastlane &amp; CI builds.
After creating you will be able to see new fastlane directory with all metadata fetched from iTunesConnect. In my case I don’t have much:</p>
</blockquote>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_4.png" alt="preview_1" width="250" />
</div>

<p>If you have some metadata on account, you will see something like this:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_5.png" alt="preview_1" width="250" />
</div>

<blockquote>
  <p>Tip - It’s recommended to use Gemfile to define all dependencies for fastlane. This will allow to define fastlane version and dependencies and share them across the team with the help of “Gemfile.lock”. The Gemfile also speed up work of fastlane.</p>
</blockquote>

<p>To prepare Gemfile you need:</p>

<ol>
  <li>Install bundler by running sudo gem install bundler</li>
  <li>Run bundler init to create Gemfile like below</li>
</ol>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_6.png" alt="preview_1" width="550" />
</div>

<p>Run <code class="language-plaintext highlighter-rouge">[sudo] bundle update</code> and add both the ./Gemfile and the ./Gemfile.lock to version control:</p>

<ul>
  <li>Every time you run fastlane, use bundle exec fastlane [lane]</li>
  <li>On your CI, add [sudo] bundle install as your first build step</li>
  <li>To update fastlane, just run [sudo] bundle update</li>
</ul>

<p>##FASTFILE config</p>

<blockquote>
  <p>Tip: FASTFILE is ruby script, evaluated by fastlane core engine when fastlane is launched, for more about ruby visit http://rubylearning.com.</p>
</blockquote>

<p><strong>FASTFILE</strong> allow you to setup build for any purpose you need. The most common - development build, adHock build, fabric distribution build, iTunes testflight build. All these tasks and, moreover, unit testing can be done with one-line fastlane call</p>

<p>The normal distribution app process consist from few pats. The main one - is code signing process.</p>

<p>Sometimes it’s hard to manage all certificates (especially if you have few developer team on same account or few apps or both of it). Developer, who prepare build, should every time control all things manually, time - to - time you can forget to check something and detect this only after build prepared or even uploaded, but that’s to late, the time is gone. Fortunately, fastlane has a perfect tool for automatic code sign and certificates managing - <strong>fastlane match</strong>.</p>

<p>I recommend to setup this tool before we start configuring the FASTFILE.</p>

<h2 id="match-setup">Match setup</h2>

<p>At the start you should create some private repository for storing certificates and provision profiles. When you’re done, open terminal, switch to folder with cd command and run match init:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_7.png" alt="preview_1" width="550" />
</div>

<p>You will be asked for repository url, type url link to connect match with it.</p>

<p>Next you will see success message and proposal to create appropriate certificates and provision profiles pairs on your repository.</p>

<p>If your certificates are not created yet - fastlane will ask about additional information to continue with your request - just follow instruction in console to complete this step.</p>

<p>Let’s create pair for appstore distribution by typing fastlane match appstore. You will see something like on screenshot below:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_8.png" alt="preview_1" width="450" />
</div>
<p><br /></p>

<p>Now, to install created certificates on any machine, just type in terminal fastlane match appstore and all certificates will be installed on the new machine (Of cause you also need to have access to repository and know pass - phrase for encrypted files on it to be able decrypt them).</p>

<blockquote>
  <p>Tip: If you care about security, repository with certificates and provisions is encrypted with your password, so they don’t appear explicitly available even in git. But for sure it’s worth having these certificates in private repository as well. It might cost some money with GitHub, but bitbucket allows unlimited private repositories so we’ll use it in this case. For more about security check https://codesigning.guide</p>
</blockquote>

<p>To answer the question «Is it secure?», just look at features that are available with <strong>fastlane match</strong>:</p>

<ul>
  <li>You have full control over the access list of your Git repo, no third party service involved</li>
  <li>Even if your certificates are leaked, they can’t be used to cause any harm without your iTunes Connect login credentials</li>
  <li>Match does not currently support In-House Enterprise profiles as they are harder to control</li>
  <li>If you use GitHub or Bitbucket we encourage enabling 2 factor authentication for all accounts that have access to the certificates repo</li>
</ul>

<p>If you go to repository source, you will see content like on screenshot below. Few separate folders with certificates and provision for each type of activity that was setup (in our case only for appStore).</p>

<blockquote>
  <p>Tip : You can run similar command to add certificates for development (<strong>fastlane match development</strong>) and adhoc (<strong>fastlane match adhoc</strong>)</p>
</blockquote>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_9.png" alt="preview_1" width="550" />
</div>

<p>Now, navigate to project folder and open fastlane directory, you will be able to see MATCHFILE. The content of this file will looks like on screenshot below.</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_10.png" alt="preview_1" width="450" />
</div>
<p><br /></p>

<p>All this information required for match command, to allow properly manage certificates and provision profiles for concrete app.</p>

<h2 id="configuration">Configuration</h2>

<p>Before opening and editing FASTFILE from the directory in your project, check Appfile - this file should contain appIdentifier of your app, appleID, teamID. If no, you can setup it’s manually, also if some info missing, this mean that something was wrong during setup process.
Appfile can look like on screenshot below:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_10.png" alt="preview_1" width="450" />
</div>
<p><br /></p>

<blockquote>
  <p>Tip: Symbol <code class="language-plaintext highlighter-rouge">#</code> indicates a line for comment purpose, so it won’t be processed by fastlane, so feel free to put any additional info in file if you want
Tip: it’s recommend to use some textEditor with additional functionality instead of standard one textEdit), because sometimes textEdit can auto change some symbols and you will get unexpected results. The good alternative can be Sublime (paid) or TextWrangler (free). But it’s always up to you to choose the most suitable way.</p>
</blockquote>

<p>Ok, let’s open FASTFILE.
When you open it, you will see some sample implementation with few lanes. It’s good point to start, thus we are ready to implement our own lane, let’s remove everything from FASTFILE to start from scratch.</p>

<blockquote>
  <p>Tip: You can go to online service and create FASTFILE with friendly UI - https://fabric.io/features/distribution?utm_campaign=github_readme.
For our tutorial we will create one lane for iTunes testflight distribution with notification on slack channel. Lets call this lane itunes.
To create new lane, simply type</p>
</blockquote>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">lane</span> <span class="ss">:&lt;</span><span class="nb">name</span><span class="o">&gt;</span> <span class="k">do</span>
<span class="k">end</span></code></pre></figure>

<p>In our case, this will be like:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">lane</span> <span class="ss">:itunes</span> <span class="k">do</span>
<span class="k">end</span></code></pre></figure>

<p>Now, you are able to run this lane from terminal by typing fastlane itunes, but it will do nothing. Try it.</p>

<p>To make our lane more useful, lets add command for building project - gym.</p>

<blockquote>
  <p>Tip: To get list of all commands simply type fastlane - show lists all available lanes with description or fastlane list - show lists all available lanes without description</p>
</blockquote>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">lane</span> <span class="ss">:itunes</span> <span class="k">do</span>
	<span class="n">gym</span><span class="p">(</span><span class="ss">scheme: </span><span class="s2">"testFastlane"</span><span class="p">,</span>
		<span class="ss">workspace: </span><span class="s2">"testFastlane.xcworkspace"</span><span class="p">,</span>
		<span class="ss">include_bitcode: </span><span class="kp">true</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>

<p>Now if you run <strong>fastlane itunes</strong>, build will be created in root directory of our project.</p>

<p>Good, but not enough. Lets add possibility to auto sign our build using match, that we configure before:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">lane</span> <span class="ss">:itunes</span> <span class="k">do</span>
	<span class="n">match</span><span class="p">(</span><span class="ss">app_identifier: </span><span class="s2">"com.testFastlane.sample"</span><span class="p">,</span> <span class="ss">type: </span><span class="s2">"appstore"</span><span class="p">)</span>
	<span class="n">gym</span><span class="p">(</span><span class="ss">scheme: </span><span class="s2">"testFastlane"</span><span class="p">,</span>
		<span class="ss">workspace: </span><span class="s2">"testFastlane.xcworkspace"</span><span class="p">,</span>
		<span class="ss">include_bitcode: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">testflight</span>
<span class="k">end</span></code></pre></figure>

<p>Now, before building app, fastlane will check certificates and install latest one. We also add additional command <strong>testflight</strong> - this command will upload your build to iTunes.
It’s better, but we can do even more:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">lane</span> <span class="ss">:itunes</span> <span class="k">do</span>
	<span class="n">ensure_git_status_clean</span>
	<span class="n">build_number</span> <span class="o">=</span> <span class="sb">`git rev - list - - count HEAD`</span>
	<span class="n">increment_build_number</span><span class="p">(</span><span class="ss">build_number: </span><span class="n">build_number</span><span class="p">,</span> <span class="ss">xcodeproj: </span><span class="s2">"testFastlane.xcodeproj"</span><span class="p">)</span>
	<span class="n">cocoapods</span><span class="p">(</span><span class="ss">use_bundle_exec: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">match</span><span class="p">(</span><span class="ss">app_identifier: </span><span class="s2">"com.testFastlane.sample"</span><span class="p">,</span> <span class="ss">type: </span><span class="s2">"appstore"</span><span class="p">)</span>
	<span class="n">gym</span><span class="p">(</span><span class="ss">scheme: </span><span class="s2">"testFastlane"</span><span class="p">,</span>
		<span class="ss">workspace: </span><span class="s2">"testFastlane.xcworkspace"</span><span class="p">,</span>
		<span class="ss">include_bitcode: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">testflight</span>
<span class="k">end</span></code></pre></figure>

<p>A lot of changes, what happened now? Going from top to bottom, we ask fastlane to:</p>

<ul>
  <li>make sure that there are no uncommitted changes in working copy,</li>
  <li>increment build number and make it equal to q-ty of commits in git</li>
  <li>run pod install. Version of cocoapods can be specified in Gemfile - no more cocoapods version unsynchronized across the team</li>
  <li>check certificates</li>
  <li>create build</li>
  <li>send it to testflight</li>
</ul>

<p>Yes, thats a lot… and just 1 line of code - fine, but even now, we can do more!</p>

<p>Let’s add additional notification to all teammate in Slack channel, to make sure that everyone be notified about new build.</p>

<blockquote>
  <p>Tip: Incoming Web-hooks are a simple way to post messages from external sources into Slack. They make use of normal HTTP requests with a JSON payload that includes the message text and some options.</p>

  <p>You may need to create Incoming WebHook for Slack integration. To do so, visit https://api.slack.com/incoming-webhooks and follow instruction on this page</p>
</blockquote>

<p>To continue, just add one more variable to FASTFILE and call slack command like below:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">ENV</span><span class="p">[</span><span class="s2">"SLACK_URL"</span><span class="p">]</span> <span class="o">||=</span> <span class="s2">"https://hooks.slack.com/services/someURL"</span>

<span class="n">lane</span> <span class="ss">:itunes</span> <span class="k">do</span>
	<span class="n">ensure_git_status_clean</span>
	<span class="n">build_number</span> <span class="o">=</span> <span class="sb">`git rev - list - - count HEAD`</span>
	<span class="n">increment_build_number</span><span class="p">(</span><span class="ss">build_number: </span><span class="n">build_number</span><span class="p">,</span> <span class="ss">xcodeproj: </span><span class="s2">"testFastlane.xcodeproj"</span><span class="p">)</span>
	<span class="n">cocoapods</span><span class="p">(</span><span class="ss">use_bundle_exec: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">match</span><span class="p">(</span><span class="ss">app_identifier: </span><span class="s2">"com.testFastlane.sample"</span><span class="p">,</span> <span class="ss">type: </span><span class="s2">"appstore"</span><span class="p">)</span>
	<span class="n">gym</span><span class="p">(</span><span class="ss">scheme: </span><span class="s2">"testFastlane"</span><span class="p">,</span>
		<span class="ss">workspace: </span><span class="s2">"testFastlane.xcworkspace"</span><span class="p">,</span>
		<span class="ss">include_bitcode: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">testflight</span>
<span class="k">end</span>

<span class="n">after_all</span> <span class="k">do</span> <span class="o">|</span><span class="n">lane</span><span class="o">|</span>
	<span class="k">if</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"SLACK_URL"</span><span class="p">]</span>
		<span class="n">slack</span><span class="p">(</span>
			<span class="ss">message: </span><span class="err">«</span><span class="no">MyAwesomeApp</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">released!</span><span class="s2">",
			success: true,
		)
	end
	
	clean_build_artifacts
end</span></code></pre></figure>

<p>Now, If you run this lane in terminal (fastlane itunes) you will got next (described by steps):</p>

<p>build increment and match step</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_12.png" alt="preview_1" width="550" />
</div>
<p><br /></p>

<p>Installing certificates and gym step:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_13.png" alt="preview_1" width="550" />
</div>
<p><br /></p>

<p>After, compile step log and iTunes upload.</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_14.png" alt="preview_1" width="550" />
</div>
<p><br /></p>

<p>And of course notification on slack</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_15.png" alt="preview_1" width="250" />
</div>
<p><br /></p>

<p>Great, now you should feel yourself better and more powerful</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_16.png" alt="preview_1" width="250" />
</div>
<p><br /></p>

<h2 id="bonus">Bonus</h2>

<p>Oh, one more thing, almost forgot about - lets add the most major part of lane by following next steps:</p>

<ol>
  <li>Create new file and put this code inside:</li>
</ol>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">ship_it</span>
	<span class="nb">rand</span> <span class="o">=</span> <span class="no">Random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
	<span class="k">if</span> <span class="nb">rand</span> <span class="o">==</span> <span class="mi">0</span>
		<span class="n">squirrel</span>
	<span class="k">elsif</span> <span class="nb">rand</span> <span class="o">==</span> <span class="mi">1</span>
		<span class="n">boat</span>
	<span class="k">end</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">squirrel</span>
	<span class="nb">puts</span> <span class="s2">"
	!!!!
	!!!!!!!!
	!!!!!!!!!!! O_O
	!!! !!!!!!! /@ @</span><span class="se">\\</span><span class="s2">
	!!!!!! </span><span class="se">\\</span><span class="s2"> x /
	!!!!!!/ m !m
	!!!!/ __ |
	!!!!|/ </span><span class="se">\\</span><span class="s2">__
	!!!</span><span class="se">\\</span><span class="s2">______</span><span class="se">\\</span><span class="s2">
	"</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">boat</span>
	<span class="nb">puts</span> <span class="s2">"
	. o ..
	o . o o.o
	…oo
	__[]__
	__|_o_o_o</span><span class="se">\_</span><span class="s2">_
	</span><span class="se">\\\"\"\"\"\"\"\"\"\"\"</span><span class="s2">/
	</span><span class="se">\\</span><span class="s2">. .. . /
	^^^^^^^^^^^^^^^^^^^^
	"</span>
	<span class="k">end</span></code></pre></figure>

<ol>
  <li>Save file and call it ship_sugar. Put file in fastlane directory.</li>
  <li>Open your FASTFILE and add next line in the very top:
<code class="language-plaintext highlighter-rouge">eval(File.open(File.expand_path("../ship_sugar", __FILE__)).read)</code></li>
  <li>Modify after_all section in FASTFILE:</li>
</ol>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">after_all</span> <span class="k">do</span> <span class="o">|</span><span class="n">lane</span><span class="o">|</span>
	<span class="k">if</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"SLACK_URL"</span><span class="p">]</span>
		<span class="n">slack</span><span class="p">(</span>
			<span class="ss">message: </span><span class="s2">"MyAwesomeApp is successfully released!"</span><span class="p">,</span>
			<span class="ss">success: </span><span class="kp">true</span><span class="p">,</span>
		<span class="p">)</span>
	<span class="k">end</span>
	<span class="n">ship_it</span>
<span class="k">end</span>
	<span class="n">clean_build_artifacts</span>
<span class="k">end</span></code></pre></figure>

<p>If you do everything as described above, at the end your FASTFILE should looks like next:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">eval</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">expand_path</span><span class="p">(</span><span class="s2">"../ship_sugar"</span><span class="p">,</span> <span class="kp">__FILE__</span><span class="p">)).</span><span class="nf">read</span><span class="p">)</span>
<span class="no">ENV</span><span class="p">[</span><span class="s2">"SLACK_URL"</span><span class="p">]</span> <span class="o">||=</span> <span class="s2">"https://hooks.slack.com/services/SomeURL"</span>

<span class="n">lane</span><span class="err"> </span><span class="ss">:itunes</span> <span class="k">do</span>
	<span class="n">ensure_git_status_clean</span>
	<span class="n">build_number</span> <span class="o">=</span> <span class="sb">`git rev - list - - count HEAD`</span>
	<span class="n">increment_build_number</span><span class="p">(</span><span class="ss">build_number: </span><span class="n">build_number</span><span class="p">,</span> <span class="ss">xcodeproj: </span><span class="s2">"testFastlane.xcodeproj"</span><span class="p">)</span>
	<span class="n">cocoapods</span><span class="p">(</span><span class="ss">use_bundle_exec: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">match</span><span class="p">(</span><span class="ss">app_identifier: </span><span class="s2">"com.testFastlane.sample"</span><span class="p">,</span> <span class="ss">type: </span><span class="s2">"appstore"</span><span class="p">)</span>
	<span class="n">gym</span><span class="p">(</span><span class="ss">scheme: </span><span class="s2">"testFastlane"</span><span class="p">,</span>
		<span class="ss">workspace: </span><span class="s2">"testFastlane.xcworkspace"</span><span class="p">,</span>
		<span class="ss">include_bitcode: </span><span class="kp">true</span><span class="p">)</span>
	<span class="n">testflight</span>
<span class="k">end</span>

<span class="n">after_all</span> <span class="k">do</span> <span class="o">|</span><span class="n">lane</span><span class="o">|</span>
	<span class="k">if</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"SLACK_URL"</span><span class="p">]</span>
		<span class="n">slack</span><span class="p">(</span>
			<span class="ss">message: </span><span class="err">«</span><span class="no">MyAwesomeApp</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">released!</span><span class="s2">",
			success: true,
		)
	end
	ship_it
end

	clean_build_artifacts
end</span></code></pre></figure>

<p>What are hell is it?</p>

<p>Be patience! Let’s run fastlane itunes, at the end, you will be able to see squirrel or ship in terminal like:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2017-01-23-fastlane-for-beginners/src_17.png" alt="preview_1" width="350" />
</div>
<p><br /></p>

<p>Nice, yeah?</p>

<p>Basically thats all you need to be able start working with fastlane.</p>

<blockquote>
  <p>Tip: To make the process even more descriptive you can use desc command like desc «Some comment that will be visible in console»</p>
</blockquote>

<h2 id="ci-integration">CI integration</h2>
<p><strong>fastlane</strong> is really powerful tool, it save for us a lot of time on project builds, but it can improve our development process even more. Since fastlane is command line one - liner, it can be used on CI server. Moreover, it can be applied to easily move project between different CI’s like Team-city, Jenkins etc.</p>

<blockquote>
  <p>Tip: CI : Continuous Integration - is the practice of merging all developer working copies to a shared mainline several times a day.. To read more - <a href="https://en.wikipedia.org/wiki/Continuous_integration">visit</a></p>
</blockquote>

<p>In one of the next article I will cover the process of integrating fastlane with CI.</p>

<p>What to do next:
If you want to do more, try to do one of next thing:</p>
<ul>
  <li>create few more lanes for development and adhoc purposes</li>
  <li>integrate crashlytics distribution</li>
  <li>integrate auto - sign (produce, cert, sigh)</li>
</ul>

<p>In this tutorial we’ve covered a lot of steps, but most of them should be done only once. As a result, fastlane will save your time every day.</p>

<p>As you can see, fastlane allows you to setup automated distribution process with fully controlled flow. You are also able to write your own part and integrate it with fastlane to make it more flexible and matching your needs.
To get more info I recommend to <a href="https://fastlane.tools/">visit official web site</a>.</p>

  </div><a class="u-url" href="/tutorial/2017/01/23/fastlane-for-beginners.html" hidden></a>
</article>

<div class="prev-next">
  
    <a class="half prev"></a>
  
  
    <a class="half next" href="/article/2018/04/28/ble-pitfalls.html">BLE pitfalls &raquo;</a>
  
</div>




<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: silver;">Share on: </span><div id="share-buttons">
    <div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="window.open('http://twitter.com/home?status=http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
    
    <div class="gplus" title="Share this on Google Plus" onclick="window.open('https://plus.google.com/share?url=http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html');"><svg viewBox="0 0 2304 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1437 913q0 208-87 370.5t-248 254-369 91.5q-149 0-285-58t-234-156-156-234-58-285 58-285 156-234 234-156 285-58q286 0 491 192l-199 191q-117-113-292-113-123 0-227.5 62t-165.5 168.5-61 232.5 61 232.5 165.5 168.5 227.5 62q83 0 152.5-23t114.5-57.5 78.5-78.5 49-83 21.5-74h-416v-252h692q12 63 12 122zm867-122v210h-209v209h-210v-209h-209v-210h209v-209h210v209h209z"/></svg></div>
    <div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=http://localhost:4000/tutorial/2017/01/23/fastlane-for-beginners.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>

<script src="  https://unpkg.com/showdown/dist/showdown.min.js"></script>
<script>
const GH_API_URL = 'https://api.github.com/repos/khorbushko/khorbushko.github.io/issues/4/comments'; // ?client_id=&client_secret=

let request = new XMLHttpRequest();
request.open( 'GET', GH_API_URL, true );
request.onload = function() {
	if ( this.status >= 200 && this.status < 400 ) {
		let response = JSON.parse( this.response );

		for ( var i = 0; i < response.length; i++ ) {
			document.getElementById( 'gh-comments-list' ).appendChild( createCommentEl( response[ i ] ) );
		}

		if ( 0 === response.length ) {
			document.getElementById( 'no-comments-found' ).style.display = 'block';
		}
	} else {
		console.error( this );
	}
};

function createCommentEl( response ) {
	let user = document.createElement( 'a' );
	user.setAttribute( 'href', response.user.url.replace( 'api.github.com/users', 'github.com' ) );
	user.classList.add( 'user' );

	let userAvatar = document.createElement( 'img' );
	userAvatar.classList.add( 'avatar' );
	userAvatar.setAttribute( 'src', response.user.avatar_url );

	user.appendChild( userAvatar );

	let commentLink = document.createElement( 'a' );
	commentLink.setAttribute( 'href', response.html_url );
	commentLink.classList.add( 'comment-url' );
	commentLink.innerHTML = '#' + response.id + ' - ' + response.created_at;

	let commentContents = document.createElement( 'div' );
	commentContents.classList.add( 'comment-content' );
	commentContents.innerHTML = response.body;
	// Progressive enhancement.
	if ( window.showdown ) {
		let converter = new showdown.Converter();
		commentContents.innerHTML = converter.makeHtml( response.body );
	}

	let comment = document.createElement( 'li' );
	comment.setAttribute( 'data-created', response.created_at );
	comment.setAttribute( 'data-author-avatar', response.user.avatar_url );
	comment.setAttribute( 'data-user-url', response.user.url );

	comment.appendChild( user );
	comment.appendChild( commentContents );
	comment.appendChild( commentLink );

	return comment;
}
request.send();
</script>

<hr>

<div class="github-comments">
	<h2>Comments</h2>
	<ul id="gh-comments-list"></ul>
	<p id="leave-a-comment">Join the discussion for this article on <a href="https://github.com/khorbushko/khorbushko.github.io/issues/4">this ticket</a>. Comments appear on this page instantly.</p>
</div>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>RSS</span>      
          </a>
          &nbsp;&nbsp;
          <a href="https://feedrabbit.com/?url=http://khorbushko.github.io">
            <svg class="svg-icon black">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Newsletter</span>      
          </a>

        </p>
        <ul class="contact-list">
          <li class="p-name">khorbushko</li>
          <li><a class="u-email" href="mailto:kirill.ge@gmail.com">kirill.ge@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>inspired by &quot;software craftsmanship&quot;</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/khorbushko" title="khorbushko"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://stackoverflow.com/users/2012219" title="2012219"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/kyryl-horbushko-67936bb5" title="kyryl-horbushko-67936bb5"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>

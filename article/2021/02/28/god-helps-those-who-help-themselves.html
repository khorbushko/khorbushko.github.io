<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>God helps those who help themselves | kyryl horbushko</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="God helps those who help themselves" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Combine improves our code and makes development much faster and easier. But, even with such an idea in mind, we can often face some issues (like “unresolved type of result”). A swift compiler is very strong-typed, so when we use it within the Combine framework we can face different errors (like “Generic parameter ‘T’ could not be inferred”). There is no limit for improvements, so some tricks can not only make coding much pleasant but also may bring some improvement into it. I would like to list here some tricks and a few pieces of advice that I found, during the last few months of life with Combine. Understand what are u doing Yep, such simple but yet powerful advice. If u have a chained transformation from some publisher(s), and u use different functions, at some point, u may lose the understanding what the type of value u operate inside the transform closure. U even may try to check the type by calling QuickHelp or checking Inspector panel, but result usually - &lt;unknown type&gt; or No Quick Help: This mean, that compiler don’t understand what u are trying to do, because downside of tranforms chaining may be a type with very complex declaration: func flatMap&lt;T, P&gt;(maxPublishers: Subscribers.Demand = .unlimited, _ transform: @escaping (Tour.Bus.Info) -&gt; P) -&gt; Publishers.FlatMap&lt;P, Publishers.FlatMap&lt;Publishers.Map&lt;Publishers.Collect&lt;Publishers.FlatMap&lt;AnyPublisher &lt;ResultHolder&gt;, Publishers.Map&lt;AnyPublisher&lt;Tour.Bus.DataResponse, Error&gt;, ResultHolder&gt;.Failure&gt;, Publishers.Sequence&lt;[AnyPublisher&lt;ResultHolder, Publishers.Map&lt;AnyPublisher&lt;Tour.Bus.DataResponse, Error&gt;, ResultHolder&gt;.Failure&gt;], Error&gt;&gt;&gt;, Tour.Bus.Info&gt;, AnyPublisher&lt;Void, Error&gt;&gt;&gt; where T == P.Output, P : Publisher, Self.Failure == P.Failure If u don’t know the type, how the compiler can? So, understand what u are doing. Be sure that u know Input and Output types on all steps required for transformations. Erase the publisher’s type As I mentioned above, the result type of transformation can be very complex, so erase it as often as u can, to simplify the result type. } .eraseToAnyPublisher() Do not use $0 in the transformation This rule just makes u’r code a bit more declarative - I, personally, forget everything I have done in a week or so, so I always try to write a code, that describes by itself what is going there. We may compare 2 code snipets: rawData .publisher .setFailureType(to: Error.self) .flatMap(maxPublishers: .max(1), { $0 }) .collect() .map { Device.Raw.Info( program: $0.compactMap { if case .program(let i) = $0 { return ProgramTransformation(i) } else { return nil } }.first!, diodes: $0.compactMap { if case .diodes(let i, let z) = $0 { return MagnitoTransformation(rawCouple: (i, z)) } else { return nil } }.first! ) } .eraseToAnyPublisher() with rawData .publisher .setFailureType(to: Error.self) .flatMap(maxPublishers: .max(1), { processingData in processingData }) .collect() .map { processedData in Device.Raw.Info( program: processedData.compactMap { currentResult in if case .program(let value) = currentResult { return ProgramTransformation(value) } else { return nil } }.first, diodes: processedData.compactMap { currentResult in if case .diodes(let diodes, let anodes) = currentResult { return MagnitoTransformation(rawCouple:(diodes, anodes)) } else { return nil } }.first ) } .eraseToAnyPublisher() The second variant more declarative and tell the story better than the first one. So - descriptively write u’r code, so later u can read it as a book. Set explicit return type Sometimes (more often than we want ;]), a compiler may report an error like Generic parameter &#39;T&#39; could not be inferred. Example contains few tranforms, that without explicit return type produce and error: private func createConnection() -&gt; AnyPublisher&lt;Iglu.Motor.Device, Error&gt; { enum Failure: Error { case deviceNotAvailable } return Deferred { self.keychainIgluStorage.load() .publisher } .tryMap { (device) -&gt; API.IgluDevice in if let device = device { return device } else { throw Failure.deviceNotAvailable } } .flatMap { storedDevice -&gt; AnyPublisher&lt;Iglu.Stored.Device, Error&gt; in Just(self.connection) .setFailureType(to: Swift.Error.self) .flatMap { connection in self.performSearch(using: connection, target: storedDevice) .eraseToAnyPublisher() } .retryWhen { error -&gt; AnyPublisher&lt;Void, Error&gt; in switch error { case Iglu.Failure.unknownState: Just(()) .delay(for: 100, scheduler: schedulerQueue) .setFailureType(to: Swift.Error.self) .eraseToAnyPublisher() } } } .flatMap { device -&gt; AnyPublisher&lt;Iglu.Motor.Device, Error&gt; in Just(self.connection) .setFailureType(to: Swift.Error.self) .flatMap { connection in self.performConnection(using: connection, on: device) .eraseToAnyPublisher() } } .eraseToAnyPublisher() } Off cause - such function is hard to read and understand, so it’s better to divide the code into smaller parts. See next advice. Put in a function just 1 functionality This is yet another simple rule - 1 function should perform 1 function. Such a way allows u to reuse functionality across different pipelines. Ur code becomes much cleaner and compact. This also makes it more readable and understandable. Use print, breakpointOnError ,and breakpoint These few additions to u’r pipeline can greatly improve the understanding of the situation and debug the code. I like to check each pipeline in detail before going to the next steps. These small utilities help a lot, with minimal effort. U can attach them at any step of u’r pipe" />
<meta property="og:description" content="Combine improves our code and makes development much faster and easier. But, even with such an idea in mind, we can often face some issues (like “unresolved type of result”). A swift compiler is very strong-typed, so when we use it within the Combine framework we can face different errors (like “Generic parameter ‘T’ could not be inferred”). There is no limit for improvements, so some tricks can not only make coding much pleasant but also may bring some improvement into it. I would like to list here some tricks and a few pieces of advice that I found, during the last few months of life with Combine. Understand what are u doing Yep, such simple but yet powerful advice. If u have a chained transformation from some publisher(s), and u use different functions, at some point, u may lose the understanding what the type of value u operate inside the transform closure. U even may try to check the type by calling QuickHelp or checking Inspector panel, but result usually - &lt;unknown type&gt; or No Quick Help: This mean, that compiler don’t understand what u are trying to do, because downside of tranforms chaining may be a type with very complex declaration: func flatMap&lt;T, P&gt;(maxPublishers: Subscribers.Demand = .unlimited, _ transform: @escaping (Tour.Bus.Info) -&gt; P) -&gt; Publishers.FlatMap&lt;P, Publishers.FlatMap&lt;Publishers.Map&lt;Publishers.Collect&lt;Publishers.FlatMap&lt;AnyPublisher &lt;ResultHolder&gt;, Publishers.Map&lt;AnyPublisher&lt;Tour.Bus.DataResponse, Error&gt;, ResultHolder&gt;.Failure&gt;, Publishers.Sequence&lt;[AnyPublisher&lt;ResultHolder, Publishers.Map&lt;AnyPublisher&lt;Tour.Bus.DataResponse, Error&gt;, ResultHolder&gt;.Failure&gt;], Error&gt;&gt;&gt;, Tour.Bus.Info&gt;, AnyPublisher&lt;Void, Error&gt;&gt;&gt; where T == P.Output, P : Publisher, Self.Failure == P.Failure If u don’t know the type, how the compiler can? So, understand what u are doing. Be sure that u know Input and Output types on all steps required for transformations. Erase the publisher’s type As I mentioned above, the result type of transformation can be very complex, so erase it as often as u can, to simplify the result type. } .eraseToAnyPublisher() Do not use $0 in the transformation This rule just makes u’r code a bit more declarative - I, personally, forget everything I have done in a week or so, so I always try to write a code, that describes by itself what is going there. We may compare 2 code snipets: rawData .publisher .setFailureType(to: Error.self) .flatMap(maxPublishers: .max(1), { $0 }) .collect() .map { Device.Raw.Info( program: $0.compactMap { if case .program(let i) = $0 { return ProgramTransformation(i) } else { return nil } }.first!, diodes: $0.compactMap { if case .diodes(let i, let z) = $0 { return MagnitoTransformation(rawCouple: (i, z)) } else { return nil } }.first! ) } .eraseToAnyPublisher() with rawData .publisher .setFailureType(to: Error.self) .flatMap(maxPublishers: .max(1), { processingData in processingData }) .collect() .map { processedData in Device.Raw.Info( program: processedData.compactMap { currentResult in if case .program(let value) = currentResult { return ProgramTransformation(value) } else { return nil } }.first, diodes: processedData.compactMap { currentResult in if case .diodes(let diodes, let anodes) = currentResult { return MagnitoTransformation(rawCouple:(diodes, anodes)) } else { return nil } }.first ) } .eraseToAnyPublisher() The second variant more declarative and tell the story better than the first one. So - descriptively write u’r code, so later u can read it as a book. Set explicit return type Sometimes (more often than we want ;]), a compiler may report an error like Generic parameter &#39;T&#39; could not be inferred. Example contains few tranforms, that without explicit return type produce and error: private func createConnection() -&gt; AnyPublisher&lt;Iglu.Motor.Device, Error&gt; { enum Failure: Error { case deviceNotAvailable } return Deferred { self.keychainIgluStorage.load() .publisher } .tryMap { (device) -&gt; API.IgluDevice in if let device = device { return device } else { throw Failure.deviceNotAvailable } } .flatMap { storedDevice -&gt; AnyPublisher&lt;Iglu.Stored.Device, Error&gt; in Just(self.connection) .setFailureType(to: Swift.Error.self) .flatMap { connection in self.performSearch(using: connection, target: storedDevice) .eraseToAnyPublisher() } .retryWhen { error -&gt; AnyPublisher&lt;Void, Error&gt; in switch error { case Iglu.Failure.unknownState: Just(()) .delay(for: 100, scheduler: schedulerQueue) .setFailureType(to: Swift.Error.self) .eraseToAnyPublisher() } } } .flatMap { device -&gt; AnyPublisher&lt;Iglu.Motor.Device, Error&gt; in Just(self.connection) .setFailureType(to: Swift.Error.self) .flatMap { connection in self.performConnection(using: connection, on: device) .eraseToAnyPublisher() } } .eraseToAnyPublisher() } Off cause - such function is hard to read and understand, so it’s better to divide the code into smaller parts. See next advice. Put in a function just 1 functionality This is yet another simple rule - 1 function should perform 1 function. Such a way allows u to reuse functionality across different pipelines. Ur code becomes much cleaner and compact. This also makes it more readable and understandable. Use print, breakpointOnError ,and breakpoint These few additions to u’r pipeline can greatly improve the understanding of the situation and debug the code. I like to check each pipeline in detail before going to the next steps. These small utilities help a lot, with minimal effort. U can attach them at any step of u’r pipe" />
<link rel="canonical" href="http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html" />
<meta property="og:url" content="http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html" />
<meta property="og:site_name" content="kyryl horbushko" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-28T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="God helps those who help themselves" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html"},"@type":"BlogPosting","url":"http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/favicon.png"}},"headline":"God helps those who help themselves","dateModified":"2021-02-28T00:00:00+02:00","datePublished":"2021-02-28T00:00:00+02:00","description":"Combine improves our code and makes development much faster and easier. But, even with such an idea in mind, we can often face some issues (like “unresolved type of result”). A swift compiler is very strong-typed, so when we use it within the Combine framework we can face different errors (like “Generic parameter ‘T’ could not be inferred”). There is no limit for improvements, so some tricks can not only make coding much pleasant but also may bring some improvement into it. I would like to list here some tricks and a few pieces of advice that I found, during the last few months of life with Combine. Understand what are u doing Yep, such simple but yet powerful advice. If u have a chained transformation from some publisher(s), and u use different functions, at some point, u may lose the understanding what the type of value u operate inside the transform closure. U even may try to check the type by calling QuickHelp or checking Inspector panel, but result usually - &lt;unknown type&gt; or No Quick Help: This mean, that compiler don’t understand what u are trying to do, because downside of tranforms chaining may be a type with very complex declaration: func flatMap&lt;T, P&gt;(maxPublishers: Subscribers.Demand = .unlimited, _ transform: @escaping (Tour.Bus.Info) -&gt; P) -&gt; Publishers.FlatMap&lt;P, Publishers.FlatMap&lt;Publishers.Map&lt;Publishers.Collect&lt;Publishers.FlatMap&lt;AnyPublisher &lt;ResultHolder&gt;, Publishers.Map&lt;AnyPublisher&lt;Tour.Bus.DataResponse, Error&gt;, ResultHolder&gt;.Failure&gt;, Publishers.Sequence&lt;[AnyPublisher&lt;ResultHolder, Publishers.Map&lt;AnyPublisher&lt;Tour.Bus.DataResponse, Error&gt;, ResultHolder&gt;.Failure&gt;], Error&gt;&gt;&gt;, Tour.Bus.Info&gt;, AnyPublisher&lt;Void, Error&gt;&gt;&gt; where T == P.Output, P : Publisher, Self.Failure == P.Failure If u don’t know the type, how the compiler can? So, understand what u are doing. Be sure that u know Input and Output types on all steps required for transformations. Erase the publisher’s type As I mentioned above, the result type of transformation can be very complex, so erase it as often as u can, to simplify the result type. } .eraseToAnyPublisher() Do not use $0 in the transformation This rule just makes u’r code a bit more declarative - I, personally, forget everything I have done in a week or so, so I always try to write a code, that describes by itself what is going there. We may compare 2 code snipets: rawData .publisher .setFailureType(to: Error.self) .flatMap(maxPublishers: .max(1), { $0 }) .collect() .map { Device.Raw.Info( program: $0.compactMap { if case .program(let i) = $0 { return ProgramTransformation(i) } else { return nil } }.first!, diodes: $0.compactMap { if case .diodes(let i, let z) = $0 { return MagnitoTransformation(rawCouple: (i, z)) } else { return nil } }.first! ) } .eraseToAnyPublisher() with rawData .publisher .setFailureType(to: Error.self) .flatMap(maxPublishers: .max(1), { processingData in processingData }) .collect() .map { processedData in Device.Raw.Info( program: processedData.compactMap { currentResult in if case .program(let value) = currentResult { return ProgramTransformation(value) } else { return nil } }.first, diodes: processedData.compactMap { currentResult in if case .diodes(let diodes, let anodes) = currentResult { return MagnitoTransformation(rawCouple:(diodes, anodes)) } else { return nil } }.first ) } .eraseToAnyPublisher() The second variant more declarative and tell the story better than the first one. So - descriptively write u’r code, so later u can read it as a book. Set explicit return type Sometimes (more often than we want ;]), a compiler may report an error like Generic parameter &#39;T&#39; could not be inferred. Example contains few tranforms, that without explicit return type produce and error: private func createConnection() -&gt; AnyPublisher&lt;Iglu.Motor.Device, Error&gt; { enum Failure: Error { case deviceNotAvailable } return Deferred { self.keychainIgluStorage.load() .publisher } .tryMap { (device) -&gt; API.IgluDevice in if let device = device { return device } else { throw Failure.deviceNotAvailable } } .flatMap { storedDevice -&gt; AnyPublisher&lt;Iglu.Stored.Device, Error&gt; in Just(self.connection) .setFailureType(to: Swift.Error.self) .flatMap { connection in self.performSearch(using: connection, target: storedDevice) .eraseToAnyPublisher() } .retryWhen { error -&gt; AnyPublisher&lt;Void, Error&gt; in switch error { case Iglu.Failure.unknownState: Just(()) .delay(for: 100, scheduler: schedulerQueue) .setFailureType(to: Swift.Error.self) .eraseToAnyPublisher() } } } .flatMap { device -&gt; AnyPublisher&lt;Iglu.Motor.Device, Error&gt; in Just(self.connection) .setFailureType(to: Swift.Error.self) .flatMap { connection in self.performConnection(using: connection, on: device) .eraseToAnyPublisher() } } .eraseToAnyPublisher() } Off cause - such function is hard to read and understand, so it’s better to divide the code into smaller parts. See next advice. Put in a function just 1 functionality This is yet another simple rule - 1 function should perform 1 function. Such a way allows u to reuse functionality across different pipelines. Ur code becomes much cleaner and compact. This also makes it more readable and understandable. Use print, breakpointOnError ,and breakpoint These few additions to u’r pipeline can greatly improve the understanding of the situation and debug the code. I like to check each pipeline in detail before going to the next steps. These small utilities help a lot, with minimal effort. U can attach them at any step of u’r pipe","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="shortcut icon" type="image/png" href="/assets/favicon.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="kyryl horbushko" />
<meta name='monetization' content='$ilp.uphold.com/GiEjnNF98h8k'>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">kyryl horbushko</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/bookNotes/">Books</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/blog/archives/">Archives</a><a class="page-link" href="/contact/">Contact</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">God helps those who help themselves</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-02-28T00:00:00+02:00" itemprop="datePublished">
        Feb 28, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">kyryl horbushko</span></span>, 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Lviv</span></span></p>

      
         
          <a class="post-tag" href="/tags/#ios">iOS</a>
         
          <a class="post-tag" href="/tags/#combine">Combine</a>
         
      
         <span style="float:right;">
          <span class="ert">
    <abbr title="Estimated reading time">Estimated reading time: </abbr>
    
    
    
    

    
    
    

    
    4 minutes
</span>
         </span>
         <br>
      </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <br>
    <ul>
  <li><a href="#understand-what-are-u-doing">Understand what are u doing</a></li>
  <li><a href="#erase-the-publishers-type">Erase the publisher’s type</a></li>
  <li><a href="#do-not-use-0-in-the-transformation">Do not use <code class="language-plaintext highlighter-rouge">$0</code> in the transformation</a></li>
  <li><a href="#set-explicit-return-type">Set explicit return type</a></li>
  <li><a href="#put-in-a-function-just-1-functionality">Put in a function just 1 functionality</a></li>
  <li><a href="#use-print-breakpointonerror-and-breakpoint">Use <code class="language-plaintext highlighter-rouge">print</code>, <code class="language-plaintext highlighter-rouge">breakpointOnError</code> ,and <code class="language-plaintext highlighter-rouge">breakpoint</code></a></li>
</ul>
    <br>
    <p><code class="language-plaintext highlighter-rouge">Combine</code> improves our code and makes development much faster and easier. But, even with such an idea in mind, we can often face some issues (like <em>“unresolved type of result”</em>). A swift compiler is very strong-typed, so when we use it within the <code class="language-plaintext highlighter-rouge">Combine</code> framework we can face different errors (like <em>“Generic parameter ‘T’ could not be inferred”</em>).</p>

<p>There is no limit for improvements, so some tricks can not only make coding much pleasant but also may bring some improvement into it.</p>

<p>I would like to list here some tricks and a few pieces of advice that I found, during the last few months of life with <code class="language-plaintext highlighter-rouge">Combine</code>.</p>

<h2 id="understand-what-are-u-doing">Understand what are u doing</h2>

<p>Yep, such simple but yet powerful advice. If u have a chained transformation from some publisher(s), and u use different functions, at some point, u may lose the understanding what the type of value u operate inside the transform closure.</p>

<p>U even may try to check the type by calling QuickHelp or checking Inspector panel, but result usually - <code class="language-plaintext highlighter-rouge">&lt;unknown type&gt;</code> or <code class="language-plaintext highlighter-rouge">No Quick Help</code>:</p>

<div style="text-align:center">
<img src="/assets/posts/images/2021-02-28-god-helps-those-who-help-themselves/no_help.png" alt="no_help" width="350" />
</div>
<p><br /></p>

<p>This mean, that compiler don’t understand what u are trying to do, because downside of tranforms chaining may be a type with very complex declaration:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="n">flatMap</span><span class="o">&lt;</span><span class="kt">T</span><span class="p">,</span> <span class="kt">P</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">maxPublishers</span><span class="p">:</span> <span class="kt">Subscribers</span><span class="o">.</span><span class="kt">Demand</span> <span class="o">=</span> <span class="o">.</span><span class="n">unlimited</span><span class="p">,</span> <span class="n">_</span> <span class="nv">transform</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Tour</span><span class="o">.</span><span class="kt">Bus</span><span class="o">.</span><span class="kt">Info</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">P</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Publishers</span><span class="o">.</span><span class="kt">FlatMap</span><span class="o">&lt;</span><span class="kt">P</span><span class="p">,</span> <span class="kt">Publishers</span><span class="o">.</span><span class="kt">FlatMap</span><span class="o">&lt;</span><span class="kt">Publishers</span><span class="o">.</span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">Publishers</span><span class="o">.</span><span class="kt">Collect</span><span class="o">&lt;</span><span class="kt">Publishers</span><span class="o">.</span><span class="kt">FlatMap</span><span class="o">&lt;</span><span class="kt">AnyPublisher</span> <span class="o">&lt;</span><span class="kt">ResultHolder</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">Publishers</span><span class="o">.</span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Tour</span><span class="o">.</span><span class="kt">Bus</span><span class="o">.</span><span class="kt">DataResponse</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">ResultHolder</span><span class="o">&gt;.</span><span class="kt">Failure</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">Publishers</span><span class="o">.</span><span class="kt">Sequence</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">ResultHolder</span><span class="p">,</span> <span class="kt">Publishers</span><span class="o">.</span><span class="kt">Map</span><span class="o">&lt;</span><span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Tour</span><span class="o">.</span><span class="kt">Bus</span><span class="o">.</span><span class="kt">DataResponse</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">ResultHolder</span><span class="o">&gt;.</span><span class="kt">Failure</span><span class="o">&gt;</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;&gt;&gt;</span><span class="p">,</span> <span class="kt">Tour</span><span class="o">.</span><span class="kt">Bus</span><span class="o">.</span><span class="kt">Info</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Void</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;&gt;&gt;</span> <span class="k">where</span> <span class="kt">T</span> <span class="o">==</span> <span class="kt">P</span><span class="o">.</span><span class="kt">Output</span><span class="p">,</span> <span class="kt">P</span> <span class="p">:</span> <span class="kt">Publisher</span><span class="p">,</span> <span class="k">Self</span><span class="o">.</span><span class="kt">Failure</span> <span class="o">==</span> <span class="kt">P</span><span class="o">.</span><span class="kt">Failure</span></code></pre></figure>

<p>If u don’t know the type, how the compiler can? So, understand what u are doing. Be sure that u know <code class="language-plaintext highlighter-rouge">Input</code> and <code class="language-plaintext highlighter-rouge">Output</code> types on all steps required for transformations.</p>

<h2 id="erase-the-publishers-type">Erase the publisher’s type</h2>

<p>As I mentioned above, the result type of transformation can be very complex, so erase it as often as u can, to simplify the result type.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"> <span class="p">}</span>
 <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span></code></pre></figure>

<h2 id="do-not-use-0-in-the-transformation">Do not use <code class="language-plaintext highlighter-rouge">$0</code> in the transformation</h2>

<p>This rule just makes u’r code a bit more declarative - I, personally, forget everything I have done in a week or so, so I always try to write a code, that describes by itself what is going there.</p>

<p>We may compare 2 code snipets:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">rawData</span>
  <span class="o">.</span><span class="n">publisher</span>
  <span class="o">.</span><span class="nf">setFailureType</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Error</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">flatMap</span><span class="p">(</span><span class="nv">maxPublishers</span><span class="p">:</span> <span class="o">.</span><span class="nf">max</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">{</span> <span class="nv">$0</span> <span class="p">})</span>
  <span class="o">.</span><span class="nf">collect</span><span class="p">()</span>
  <span class="o">.</span><span class="n">map</span> <span class="p">{</span>
    <span class="kt">Device</span><span class="o">.</span><span class="kt">Raw</span><span class="o">.</span><span class="kt">Info</span><span class="p">(</span>
      <span class="nv">program</span><span class="p">:</span> <span class="nv">$0</span><span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span>
          <span class="k">if</span> <span class="k">case</span> <span class="o">.</span><span class="nf">program</span><span class="p">(</span><span class="k">let</span> <span class="nv">i</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$0</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">ProgramTransformation</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">nil</span>
          <span class="p">}</span>
      <span class="p">}</span><span class="o">.</span><span class="n">first</span><span class="o">!</span><span class="p">,</span>
      <span class="nv">diodes</span><span class="p">:</span> <span class="nv">$0</span><span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">case</span> <span class="o">.</span><span class="nf">diodes</span><span class="p">(</span><span class="k">let</span> <span class="nv">i</span><span class="p">,</span> <span class="k">let</span> <span class="nv">z</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$0</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kt">MagnitoTransformation</span><span class="p">(</span><span class="nv">rawCouple</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>
      <span class="p">}</span><span class="o">.</span><span class="n">first</span><span class="o">!</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span></code></pre></figure>

<p>with</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">rawData</span>
<span class="o">.</span><span class="n">publisher</span>
<span class="o">.</span><span class="nf">setFailureType</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Error</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
<span class="o">.</span><span class="nf">flatMap</span><span class="p">(</span><span class="nv">maxPublishers</span><span class="p">:</span> <span class="o">.</span><span class="nf">max</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">{</span> <span class="n">processingData</span> <span class="k">in</span>
  <span class="n">processingData</span>
<span class="p">})</span>
<span class="o">.</span><span class="nf">collect</span><span class="p">()</span>
<span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">processedData</span> <span class="k">in</span>
  <span class="kt">Device</span><span class="o">.</span><span class="kt">Raw</span><span class="o">.</span><span class="kt">Info</span><span class="p">(</span>
    <span class="nv">program</span><span class="p">:</span> <span class="n">processedData</span><span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span> <span class="n">currentResult</span> <span class="k">in</span>
      <span class="k">if</span> <span class="k">case</span> <span class="o">.</span><span class="nf">program</span><span class="p">(</span><span class="k">let</span> <span class="nv">value</span><span class="p">)</span> <span class="o">=</span> <span class="n">currentResult</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">ProgramTransformation</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">nil</span>
      <span class="p">}</span>
    <span class="p">}</span><span class="o">.</span><span class="n">first</span><span class="p">,</span>
    <span class="nv">diodes</span><span class="p">:</span> <span class="n">processedData</span><span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span> <span class="n">currentResult</span> <span class="k">in</span>
      <span class="k">if</span> <span class="k">case</span> <span class="o">.</span><span class="nf">diodes</span><span class="p">(</span><span class="k">let</span> <span class="nv">diodes</span><span class="p">,</span> <span class="k">let</span> <span class="nv">anodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">currentResult</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">MagnitoTransformation</span><span class="p">(</span><span class="nv">rawCouple</span><span class="p">:(</span><span class="n">diodes</span><span class="p">,</span> <span class="n">anodes</span><span class="p">))</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">nil</span>
      <span class="p">}</span>
    <span class="p">}</span><span class="o">.</span><span class="n">first</span>
  <span class="p">)</span>
<span class="p">}</span>
<span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span></code></pre></figure>

<p>The second variant more declarative and tell the story better than the first one. So - descriptively write u’r code, so later u can read it as a book.</p>

<h2 id="set-explicit-return-type">Set explicit return type</h2>

<p>Sometimes (more often than we want ;]), a compiler may report an error like</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kt">Generic</span> <span class="n">parameter</span> <span class="sc">'T'</span> <span class="n">could</span> <span class="n">not</span> <span class="n">be</span> <span class="n">inferred</span><span class="o">.</span></code></pre></figure>

<p>Example contains few tranforms, that without explicit return type produce and error:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">private</span> <span class="kd">func</span> <span class="nf">createConnection</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Iglu</span><span class="o">.</span><span class="kt">Motor</span><span class="o">.</span><span class="kt">Device</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">enum</span> <span class="kt">Failure</span><span class="p">:</span> <span class="kt">Error</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">deviceNotAvailable</span>
  <span class="p">}</span>

  <span class="k">return</span>
    <span class="kt">Deferred</span> <span class="p">{</span>
      <span class="k">self</span><span class="o">.</span><span class="n">keychainIgluStorage</span><span class="o">.</span><span class="nf">load</span><span class="p">()</span>
        <span class="o">.</span><span class="n">publisher</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="n">tryMap</span> <span class="p">{</span> <span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">API</span><span class="o">.</span><span class="kt">IgluDevice</span> <span class="k">in</span>
      <span class="k">if</span> <span class="k">let</span> <span class="nv">device</span> <span class="o">=</span> <span class="n">device</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">device</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="kt">Failure</span><span class="o">.</span><span class="n">deviceNotAvailable</span>
      <span class="p">}</span>
   <span class="p">}</span>
  <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">storedDevice</span> <span class="o">-&gt;</span> <span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Iglu</span><span class="o">.</span><span class="kt">Stored</span><span class="o">.</span><span class="kt">Device</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="k">in</span>
      <span class="kt">Just</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">connection</span><span class="p">)</span>
      <span class="o">.</span><span class="nf">setFailureType</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Swift</span><span class="o">.</span><span class="kt">Error</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
      <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">connection</span> <span class="k">in</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">performSearch</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span> <span class="nv">target</span><span class="p">:</span> <span class="n">storedDevice</span><span class="p">)</span>
          <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
      <span class="p">}</span>
      <span class="o">.</span><span class="n">retryWhen</span> <span class="p">{</span> <span class="n">error</span> <span class="o">-&gt;</span> <span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Void</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="k">in</span>
        <span class="k">switch</span> <span class="n">error</span> <span class="p">{</span>
          <span class="k">case</span> <span class="kt">Iglu</span><span class="o">.</span><span class="kt">Failure</span><span class="o">.</span><span class="nv">unknownState</span><span class="p">:</span>
            <span class="kt">Just</span><span class="p">(())</span>
              <span class="o">.</span><span class="nf">delay</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">scheduler</span><span class="p">:</span> <span class="n">schedulerQueue</span><span class="p">)</span>
              <span class="o">.</span><span class="nf">setFailureType</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Swift</span><span class="o">.</span><span class="kt">Error</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
              <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
        <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">}</span>
  <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">device</span> <span class="o">-&gt;</span> <span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Iglu</span><span class="o">.</span><span class="kt">Motor</span><span class="o">.</span><span class="kt">Device</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="k">in</span>
    <span class="kt">Just</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">connection</span><span class="p">)</span>
      <span class="o">.</span><span class="nf">setFailureType</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">Swift</span><span class="o">.</span><span class="kt">Error</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
      <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">connection</span> <span class="k">in</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">performConnection</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">device</span><span class="p">)</span>
          <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
      <span class="p">}</span>
   <span class="p">}</span>
  <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
<span class="p">}</span></code></pre></figure>

<blockquote>
  <p>Off cause - such function is hard to read and understand, so it’s better to divide the code into smaller parts. See next advice.</p>
</blockquote>

<h2 id="put-in-a-function-just-1-functionality">Put in a function just 1 functionality</h2>

<p>This is yet another simple rule - 1 function should perform 1 function. Such a way allows u to reuse functionality across different pipelines.</p>

<p>Ur code becomes much cleaner and compact. This also makes it more readable and understandable.</p>

<h2 id="use-print-breakpointonerror-and-breakpoint">Use <code class="language-plaintext highlighter-rouge">print</code>, <code class="language-plaintext highlighter-rouge">breakpointOnError</code> ,and <code class="language-plaintext highlighter-rouge">breakpoint</code></h2>

<p>These few additions to u’r pipeline can greatly improve the understanding of the situation and debug the code.</p>

<p>I like to check each pipeline in detail before going to the next steps. These small utilities help a lot, with minimal effort.</p>

<blockquote>
  <p>U can attach them at any step of u’r pipe</p>
</blockquote>

  </div><a class="u-url" href="/article/2021/02/28/god-helps-those-who-help-themselves.html" hidden></a>
</article>

<div class="prev-next">
  
    <a class="half prev" href="/article/2021/02/20/save-resources.html">&laquo; Save resources</a>
  
  
    <a class="half next" href="/article/2021/03/05/using-file.html">a File &raquo;</a>
  
</div>




<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: silver;">Share on: </span><div id="share-buttons">
    <div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="window.open('http://twitter.com/home?status=http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
    
    <div class="gplus" title="Share this on Google Plus" onclick="window.open('https://plus.google.com/share?url=http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html');"><svg viewBox="0 0 2304 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1437 913q0 208-87 370.5t-248 254-369 91.5q-149 0-285-58t-234-156-156-234-58-285 58-285 156-234 234-156 285-58q286 0 491 192l-199 191q-117-113-292-113-123 0-227.5 62t-165.5 168.5-61 232.5 61 232.5 165.5 168.5 227.5 62q83 0 152.5-23t114.5-57.5 78.5-78.5 49-83 21.5-74h-416v-252h692q12 63 12 122zm867-122v210h-209v209h-210v-209h-209v-210h209v-209h210v209h209z"/></svg></div>
    <div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=http://localhost:4000/article/2021/02/28/god-helps-those-who-help-themselves.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>

<script src="  https://unpkg.com/showdown/dist/showdown.min.js"></script>
<script>
const GH_API_URL = 'https://api.github.com/repos/khorbushko/khorbushko.github.io/issues/31/comments'; // ?client_id=&client_secret=

let request = new XMLHttpRequest();
request.open( 'GET', GH_API_URL, true );
request.onload = function() {
	if ( this.status >= 200 && this.status < 400 ) {
		let response = JSON.parse( this.response );

		for ( var i = 0; i < response.length; i++ ) {
			document.getElementById( 'gh-comments-list' ).appendChild( createCommentEl( response[ i ] ) );
		}

		if ( 0 === response.length ) {
			document.getElementById( 'no-comments-found' ).style.display = 'block';
		}
	} else {
		console.error( this );
	}
};

function createCommentEl( response ) {
	let user = document.createElement( 'a' );
	user.setAttribute( 'href', response.user.url.replace( 'api.github.com/users', 'github.com' ) );
	user.classList.add( 'user' );

	let userAvatar = document.createElement( 'img' );
	userAvatar.classList.add( 'avatar' );
	userAvatar.setAttribute( 'src', response.user.avatar_url );

	user.appendChild( userAvatar );

	let commentLink = document.createElement( 'a' );
	commentLink.setAttribute( 'href', response.html_url );
	commentLink.classList.add( 'comment-url' );
	commentLink.innerHTML = '#' + response.id + ' - ' + response.created_at;

	let commentContents = document.createElement( 'div' );
	commentContents.classList.add( 'comment-content' );
	commentContents.innerHTML = response.body;
	// Progressive enhancement.
	if ( window.showdown ) {
		let converter = new showdown.Converter();
		commentContents.innerHTML = converter.makeHtml( response.body );
	}

	let comment = document.createElement( 'li' );
	comment.setAttribute( 'data-created', response.created_at );
	comment.setAttribute( 'data-author-avatar', response.user.avatar_url );
	comment.setAttribute( 'data-user-url', response.user.url );

	comment.appendChild( user );
	comment.appendChild( commentContents );
	comment.appendChild( commentLink );

	return comment;
}
request.send();
</script>

<hr>

<div class="github-comments">
	<h2>Comments</h2>
	<ul id="gh-comments-list"></ul>
	<p id="leave-a-comment">Join the discussion for this article on <a href="https://github.com/khorbushko/khorbushko.github.io/issues/31">this ticket</a>. Comments appear on this page instantly.</p>
</div>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>RSS</span>      
          </a>
          &nbsp;&nbsp;
          <a href="https://feedrabbit.com/?url=http://khorbushko.github.io">
            <svg class="svg-icon black">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Newsletter</span>      
          </a>

        </p>
        <ul class="contact-list">
          <li class="p-name">khorbushko</li>
          <li><a class="u-email" href="mailto:kirill.ge@gmail.com">kirill.ge@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>inspired by &quot;software craftsmanship&quot;</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/khorbushko" title="khorbushko"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://stackoverflow.com/users/2012219" title="2012219"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#stackoverflow"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/kyryl-horbushko-67936bb5" title="kyryl-horbushko-67936bb5"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>

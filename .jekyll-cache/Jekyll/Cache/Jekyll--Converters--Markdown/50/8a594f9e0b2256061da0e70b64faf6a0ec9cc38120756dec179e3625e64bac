I"è+<p><code class="language-plaintext highlighter-rouge">iOS 13+</code> <code class="language-plaintext highlighter-rouge">swiftUI</code></p>

<p>If u want to present some <code class="language-plaintext highlighter-rouge">View</code> in <code class="language-plaintext highlighter-rouge">SwiftUI</code> over whole content like <code class="language-plaintext highlighter-rouge">Alert</code> or <code class="language-plaintext highlighter-rouge">UIViewController</code> does (with <code class="language-plaintext highlighter-rouge">overCurrentContext</code> style) with transparent background - u will be surprized.</p>

<p>What u can - actually create <code class="language-plaintext highlighter-rouge">View</code> and show it under current context but not under <code class="language-plaintext highlighter-rouge">TabBar</code> for example. That‚Äôs not your responsibility. And it‚Äôs true, except in the case when u want to show an alert with <code class="language-plaintext highlighter-rouge">Image</code> - this is definitely not a standard one, so you need to design it and present ‚Ä¶ somehow.</p>

<p>One option is to always present it from an appropriate context - but sometimes it‚Äôs hard to achieve and we would like to make it in the same way as Apple does within <code class="language-plaintext highlighter-rouge">.alert</code>.</p>

<p>How to achieve this? Well, we can use <code class="language-plaintext highlighter-rouge">UIKit</code>.
<!--more--></p>

<p>All that we need - is to create <code class="language-plaintext highlighter-rouge">UIViewController</code>, configure the appropriate presentation style, add content, and present on the root window.</p>

<p>Let‚Äôs start at one-by-one.</p>

<p>To <strong>find presenter</strong> we can use well-known approach of selecting <code class="language-plaintext highlighter-rouge">topMostViewController</code> - our presenter:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">extension</span> <span class="kt">UIWindow</span> <span class="p">{</span>
    
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">topMostController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">keyWindow</span> <span class="o">=</span> <span class="kt">UIApplication</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">windows</span>
            <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">isKeyWindow</span> <span class="p">}</span>
            <span class="o">.</span><span class="n">first</span>
        
        <span class="k">if</span> <span class="k">var</span> <span class="nv">topController</span> <span class="o">=</span> <span class="n">keyWindow</span><span class="p">?</span><span class="o">.</span><span class="n">rootViewController</span> <span class="p">{</span>
            <span class="k">while</span> <span class="k">let</span> <span class="nv">presentedViewController</span> <span class="o">=</span> <span class="n">topController</span><span class="o">.</span><span class="n">presentedViewController</span> <span class="p">{</span>
                <span class="n">topController</span> <span class="o">=</span> <span class="n">presentedViewController</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="n">topController</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>To <strong>create <code class="language-plaintext highlighter-rouge">UIViewController</code> and configure appropriate presentation style</strong> - nothing special also:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="nv">presentableContent</span> <span class="o">=</span> <span class="kt">UIViewController</span><span class="p">()</span>
<span class="n">presentableContent</span><span class="o">.</span><span class="n">modalPresentationStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">overCurrentContext</span>
<span class="n">presentableContent</span><span class="o">.</span><span class="n">modalTransitionStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">crossDissolve</span>
<span class="n">presentableContent</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">clear</span></code></pre></figure>

<p>The last step - add a modifier to allow usage in <code class="language-plaintext highlighter-rouge">SwiftIU</code> flow. Here we also got one more task - is how to populate any content that we want in our <code class="language-plaintext highlighter-rouge">UIViewController</code>? Well - use <code class="language-plaintext highlighter-rouge">UIHostingController</code>. Combining all together:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">import</span> <span class="kt">Foundation</span>
<span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">extension</span> <span class="kt">View</span> <span class="p">{</span>
    
    <span class="kd">func</span> <span class="n">presentContentOverFullScreen</span><span class="o">&lt;</span><span class="kt">ContentView</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="nv">isPresented</span><span class="p">:</span> <span class="kt">Binding</span><span class="o">&lt;</span><span class="kt">Bool</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="nv">content</span><span class="p">:</span> <span class="p">(</span><span class="kt">Binding</span><span class="o">&lt;</span><span class="kt">Bool</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">ContentView</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kd">some</span> <span class="kt">View</span> <span class="k">where</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="n">isPresented</span><span class="o">.</span><span class="n">wrappedValue</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">presentableContent</span> <span class="o">=</span> <span class="kt">PresentedHostingController</span><span class="o">&lt;</span><span class="kt">ContentView</span><span class="o">&gt;</span><span class="p">(</span>
                <span class="nv">rootView</span><span class="p">:</span> <span class="nf">content</span><span class="p">(</span><span class="n">isPresented</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">presentableContent</span><span class="o">.</span><span class="n">modalPresentationStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">overCurrentContext</span>
            <span class="n">presentableContent</span><span class="o">.</span><span class="n">modalTransitionStyle</span> <span class="o">=</span> <span class="o">.</span><span class="n">crossDissolve</span>
            <span class="n">presentableContent</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">clear</span>
            
            <span class="kt">UIWindow</span><span class="o">.</span><span class="n">topMostController</span><span class="p">?</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">presentableContent</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">controller</span> <span class="o">=</span> <span class="kt">UIWindow</span><span class="o">.</span><span class="n">topMostController</span>
                <span class="k">as?</span> <span class="kt">PresentedHostingController</span><span class="o">&lt;</span><span class="kt">ContentView</span><span class="o">&gt;</span> <span class="p">{</span>
                <span class="n">controller</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">fileprivate</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">PresentedHostingController</span><span class="o">&lt;</span><span class="kt">Content</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="kt">UIHostingController</span><span class="o">&lt;</span><span class="kt">Content</span><span class="o">&gt;</span> <span class="k">where</span> <span class="kt">Content</span><span class="p">:</span> <span class="kt">View</span>
<span class="p">{</span>
    <span class="cm">/*dummy*/</span>
<span class="p">}</span></code></pre></figure>

<p>Here you can find a tricky thing - I passed <code class="language-plaintext highlighter-rouge">isPresented: Binding&lt;Bool&gt;</code> in both - modifier and <code class="language-plaintext highlighter-rouge">PresentedHostingController</code> - why? Actually, we have a few reasons:</p>

<ol>
  <li>to allow dismiss the process of <code class="language-plaintext highlighter-rouge">PresentedHostingController</code> based on changes related to <code class="language-plaintext highlighter-rouge">isPresented</code></li>
  <li>to allow our <code class="language-plaintext highlighter-rouge">Content</code> to decide when to dismiss itself - like it was done by <code class="language-plaintext highlighter-rouge">.alert</code>.</li>
</ol>

<p>Few notes about dismiss logic - it‚Äôs not ideal but this approach is way better than for example capture variables within the controller and refer to it.</p>

<p>This moment also can be improved - by checking <code class="language-plaintext highlighter-rouge">presentingController</code> existence (to make sure that we don‚Äôt present few controllers on one presenter) and by adding some <code class="language-plaintext highlighter-rouge">identifier</code> to the container (to make sure that we dismiss the required presented controller).</p>
:ET